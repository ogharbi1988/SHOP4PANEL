<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHOP 4 PANEL - Vente IPTV</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --dark-color: #2c3e50;
            --light-color: #f8f9fa;
            --sidebar-width: 260px;
            --header-height: 70px;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fb;
            color: #333;
            overflow-x: hidden;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background: linear-gradient(180deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            transition: all 0.3s;
            z-index: 1000;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-header h3 {
            margin: 0;
            font-weight: 700;
        }
        
        .sidebar-menu {
            padding: 20px 0;
        }
        
        .sidebar-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-menu li {
            margin-bottom: 5px;
        }
        
        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 4px solid var(--secondary-color);
        }
        
        .sidebar-menu i {
            margin-right: 10px;
            font-size: 18px;
            width: 20px;
            text-align: center;
        }
        
        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 20px;
            transition: all 0.3s;
        }
        
        /* Header */
        .header {
            height: var(--header-height);
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            border-radius: 10px;
        }
        
        .header-left h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .balance-card {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .balance-card h3 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
        }
        
        .balance-card p {
            margin: 5px 0 0;
            opacity: 0.9;
        }
        
        /* Card Styles */
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 20px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            background-color: white;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            padding: 15px 20px;
            border-radius: 10px 10px 0 0 !important;
        }
        
        .card-body {
            padding: 20px;
        }
        
        /* Product Card */
        .product-card {
            position: relative;
            overflow: hidden;
        }
        
        .product-card .card-body {
            padding: 15px;
        }
        
        .product-image {
            height: 150px;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .product-price {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .product-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .product-duration {
            color: var(--secondary-color);
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .product-features {
            display: flex;
            margin-bottom: 15px;
        }
        
        .product-feature {
            margin-right: 10px;
            font-size: 12px;
            color: var(--secondary-color);
        }
        
        /* Buttons */
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            border-radius: 6px;
            padding: 8px 15px;
            font-weight: 500;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }
        
        .btn-success {
            background-color: var(--success-color);
            border-color: var(--success-color);
            border-radius: 6px;
            padding: 8px 15px;
            font-weight: 500;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            border-color: var(--warning-color);
            color: #212529;
            border-radius: 6px;
            padding: 8px 15px;
            font-weight: 500;
        }
        
        /* Badges */
        .badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 500;
        }
        
        /* Table */
        .table th {
            border-top: none;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        /* Login Page */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
        }
        
        .login-card {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            width: 100%;
            max-width: 400px;
        }
        
        .login-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #2980b9 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .login-body {
            padding: 30px;
        }
        
        .form-control {
            border-radius: 6px;
            padding: 10px 15px;
            border: 1px solid #e1e5eb;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        /* Tabs */
        .nav-tabs {
            border-bottom: 1px solid #e1e5eb;
        }
        
        .nav-tabs .nav-link {
            border: none;
            color: var(--secondary-color);
            font-weight: 500;
            padding: 10px 20px;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            background-color: transparent;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
                overflow: hidden;
            }
            
            .sidebar-header h3, .sidebar-menu span {
                display: none;
            }
            
            .sidebar-menu a {
                justify-content: center;
                padding: 15px;
            }
            
            .sidebar-menu i {
                margin-right: 0;
                font-size: 20px;
            }
            
            .main-content {
                margin-left: 70px;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .menu-toggle {
                display: block;
            }
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }
        
        /* Notification Bell */
        .notification-bell {
            position: relative;
            margin-right: 20px;
            font-size: 20px;
            color: var(--secondary-color);
            cursor: pointer;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Search Box */
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-box input {
            padding-left: 40px;
            border-radius: 30px;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 12px;
            color: var(--secondary-color);
        }
        
        /* Ticket Status */
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-open {
            background-color: rgba(25, 135, 84, 0.1);
            color: var(--success-color);
        }
        
        .status-pending {
            background-color: rgba(255, 193, 7, 0.1);
            color: #856404;
        }
        
        .status-closed {
            background-color: rgba(108, 117, 125, 0.1);
            color: var(--secondary-color);
        }
        
        /* Admin Badge */
        .admin-badge {
            background-color: var(--danger-color);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: 5px;
        }
        
        /* Marquee Style */
        .marquee-container {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 10px 0;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .marquee {
            white-space: nowrap;
            display: inline-block;
            animation: marquee 20s linear infinite;
            font-weight: 600;
            font-size: 16px;
        }
        
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .marquee i {
            margin-right: 10px;
            color: #fff;
        }
        
        /* Logo Styles */
        .logo {
            font-weight: 800;
            font-size: 28px;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            display: inline-block;
            padding: 10px 15px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            position: relative;
            overflow: hidden;
        }
        
        .logo::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        .logo:hover::before {
            left: 100%;
        }
        
        .logo-small {
            font-size: 20px;
            padding: 5px 10px;
        }
        
        /* Product Management */
        .product-management {
            margin-bottom: 20px;
        }
        
        .code-item {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--primary-color);
        }
        
        .code-actions {
            display: flex;
            gap: 10px;
        }
        
        .product-stats {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            color: var(--secondary-color);
        }
        
        /* Purchase Success Modal */
        .purchase-success {
            text-align: center;
            padding: 20px;
        }
        
        .purchase-success i {
            font-size: 60px;
            color: var(--success-color);
            margin-bottom: 20px;
        }
        
        /* Promotion Popup */
        .promotion-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 2000;
            max-width: 500px;
            width: 90%;
            overflow: hidden;
            display: none;
        }
        
        .promotion-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .promotion-body {
            padding: 20px;
        }
        
        .promotion-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1999;
            display: none;
        }
        
        /* Test User Countdown */
        .test-user-countdown {
            background: linear-gradient(135deg, var(--warning-color), #e67e22);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        /* Payment Methods */
        .payment-method-card {
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-method-card:hover {
            border-color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.05);
        }
        
        .payment-method-card.selected {
            border-color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .payment-method-icon {
            font-size: 24px;
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        /* Arabic Text */
        .arabic-text {
            direction: rtl;
            text-align: right;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Image Preview */
        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }
        
        /* Language Switcher */
        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .lang-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 5px;
        }
        
        .lang-btn.active {
            background: rgba(255,255,255,0.4);
            font-weight: bold;
        }
        
        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }
        
        /* Category Badge */
        .category-badge {
            background-color: var(--warning-color);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="lang-btn active" data-lang="fr">FR</button>
        <button class="lang-btn" data-lang="ar">AR</button>
    </div>

    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-card fade-in">
            <div class="login-header">
                <div class="logo">SHOP 4 PANEL</div>
                <p class="mb-0 mt-2" data-i18n="login_title">Connexion à votre compte</p>
            </div>
            <div class="login-body">
                <form id="login-form">
                    <div class="mb-3">
                        <label for="email" class="form-label" data-i18n="email">Email</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                            <input type="email" class="form-control" id="email" placeholder="Votre email" data-i18n-placeholder="email_placeholder" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="password" class="form-label" data-i18n="password">Mot de passe</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-lock"></i></span>
                            <input type="password" class="form-control" id="password" placeholder="Votre mot de passe" data-i18n-placeholder="password_placeholder" required>
                        </div>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="remember">
                        <label class="form-check-label" for="remember" data-i18n="remember_me">Se souvenir de moi</label>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary" data-i18n="login_button">Se connecter</button>
                    </div>
                    <div class="mt-3 text-center">
                        <p class="mb-0" data-i18n="demo_account">Compte de démonstration:</p>
                        <p class="mb-0"><strong>Admin:</strong> admin@shop4panel.com / admin123</p>
                        <p class="mb-0"><strong>Utilisateur:</strong> user@shop4panel.com / user123</p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo logo-small">SHOP 4 PANEL</div>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li><a href="#" class="active" data-page="dashboard-home"><i class="fas fa-home"></i> <span data-i18n="dashboard">Tableau de bord</span></a></li>
                    <li><a href="#" data-page="products"><i class="fas fa-box"></i> <span data-i18n="products">Produits IPTV</span></a></li>
                    <li><a href="#" data-page="balance"><i class="fas fa-wallet"></i> <span data-i18n="balance">Mon solde</span></a></li>
                    <li><a href="#" data-page="tickets"><i class="fas fa-ticket-alt"></i> <span data-i18n="tickets">Tickets</span></a></li>
                    <li><a href="#" data-page="history"><i class="fas fa-history"></i> <span data-i18n="history">Historique</span></a></li>
                    <li><a href="#" data-page="generator"><i class="fas fa-key"></i> <span data-i18n="generator">Générateur</span></a></li>
                    <li id="admin-menu-item" style="display: none;"><a href="#" data-page="admin"><i class="fas fa-cogs"></i> <span data-i18n="administration">Administration</span></a></li>
                    <li><a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> <span data-i18n="logout">Déconnexion</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <h1 id="page-title" data-i18n="dashboard">Tableau de bord</h1>
                </div>
                <div class="header-right">
                    <div class="notification-bell">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">AB</div>
                        <div>
                            <div class="fw-bold" id="user-name">Admin User</div>
                            <div class="small text-muted" id="user-role">Administrateur</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Test User Countdown -->
            <div id="test-user-countdown" class="test-user-countdown" style="display: none;">
                <i class="fas fa-clock me-2"></i>
                <span id="countdown-text" data-i18n="test_user_countdown">Temps restant pour votre compte test: </span>
                <span id="countdown-timer" class="fw-bold"></span>
            </div>

            <!-- Marquee Message -->
            <div class="marquee-container">
                <div class="marquee">
                    <i class="fas fa-exclamation-circle"></i>
                    <span data-i18n="marquee_message">IMPORTANT : Le montant minimum de recharge est de 500 DH. Veuillez vous assurer d'avoir un solde suffisant avant de faire un achat.</span>
                </div>
            </div>

            <!-- Dashboard Home -->
            <div id="dashboard-home" class="page-content">
                <div class="row">
                    <div class="col-md-3">
                        <div class="balance-card">
                            <h3 id="user-balance">1500.00 MAD</h3>
                            <p data-i18n="current_balance">Solde actuel</p>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <i class="fas fa-box fa-2x text-primary mb-3"></i>
                                        <h4 id="products-count">6</h4>
                                        <p class="text-muted" data-i18n="available_products">Produits disponibles</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <i class="fas fa-shopping-cart fa-2x text-success mb-3"></i>
                                        <h4>4</h4>
                                        <p class="text-muted" data-i18n="monthly_sales">Ventes ce mois</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <i class="fas fa-ticket-alt fa-2x text-warning mb-3"></i>
                                        <h4>5</h4>
                                        <p class="text-muted" data-i18n="open_tickets">Tickets ouverts</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="popular_products">Produits populaires</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th data-i18n="product">Produit</th>
                                                <th data-i18n="price">Prix</th>
                                                <th data-i18n="sales">Ventes</th>
                                                <th data-i18n="status">Statut</th>
                                            </tr>
                                        </thead>
                                        <tbody id="popular-products">
                                            <!-- Products will be populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Sales Chart for Admin -->
                        <div id="sales-chart-container" class="card mt-4" style="display: none;">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="sales_statistics">Statistiques des ventes</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="salesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="recent_activity">Dernières activités</h5>
                            </div>
                            <div class="card-body">
                                <div class="activity-list">
                                    <div class="activity-item mb-3">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0">
                                                <i class="fas fa-shopping-cart text-success"></i>
                                            </div>
                                            <div class="flex-grow-1 ms-3">
                                                <p class="mb-0">Achat de King 365 M3U 12 MOIS</p>
                                                <small class="text-muted">Il y a 2 minutes</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="activity-item mb-3">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0">
                                                <i class="fas fa-ticket-alt text-warning"></i>
                                            </div>
                                            <div class="flex-grow-1 ms-3">
                                                <p class="mb-0">Nouveau ticket créé</p>
                                                <small class="text-muted">Il y a 15 minutes</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="activity-item mb-3">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0">
                                                <i class="fas fa-key text-primary"></i>
                                            </div>
                                            <div class="flex-grow-1 ms-3">
                                                <p class="mb-0">Code généré pour SMART+</p>
                                                <small class="text-muted">Il y a 1 heure</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0">
                                                <i class="fas fa-wallet text-info"></i>
                                            </div>
                                            <div class="flex-grow-1 ms-3">
                                                <p class="mb-0">Rechargement de 200 MAD</p>
                                                <small class="text-muted">Il y a 3 heures</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Page -->
            <div id="products" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0" data-i18n="product_catalog">Catalogue des produits IPTV</h5>
                    </div>
                    <div class="card-body">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" id="product-search" placeholder="Rechercher un produit..." data-i18n-placeholder="search_product">
                        </div>
                        <div class="mb-3">
                            <label for="category-filter" class="form-label" data-i18n="filter_by_category">Filtrer par catégorie:</label>
                            <select class="form-select" id="category-filter">
                                <option value="all" data-i18n="all_categories">Toutes les catégories</option>
                                <option value="M3U">M3U</option>
                                <option value="Code">Code</option>
                            </select>
                        </div>
                        <div class="row" id="products-container">
                            <!-- Products will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Balance Page -->
            <div id="balance" class="page-content" style="display: none;">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="my_balance">Mon solde</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="balance-card">
                                            <h3 id="current-balance">1500.00 MAD</h3>
                                            <p data-i18n="current_balance">Solde actuel</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-body text-center">
                                                <i class="fas fa-plus-circle fa-3x text-primary mb-3"></i>
                                                <h5 data-i18n="recharge_balance">Recharger mon solde</h5>
                                                <p class="text-muted" data-i18n="choose_payment_method">Choisissez votre méthode de paiement</p>
                                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#rechargeModal" data-i18n="request_recharge">Demander une recharge</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <h5 data-i18n="recharge_history">Historique des rechargements</h5>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th data-i18n="date">Date</th>
                                                    <th data-i18n="amount">Montant</th>
                                                    <th data-i18n="method">Méthode</th>
                                                    <th data-i18n="status">Statut</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>15/10/2023</td>
                                                    <td>200.00 MAD</td>
                                                    <td>Admin</td>
                                                    <td><span class="badge bg-success" data-i18n="completed">Complétée</span></td>
                                                </tr>
                                                <tr>
                                                    <td>05/10/2023</td>
                                                    <td>100.00 MAD</td>
                                                    <td>Admin</td>
                                                    <td><span class="badge bg-success" data-i18n="completed">Complétée</span></td>
                                                </tr>
                                                <tr>
                                                    <td>25/09/2023</td>
                                                    <td>500.00 MAD</td>
                                                    <td>Admin</td>
                                                    <td><span class="badge bg-success" data-i18n="completed">Complétée</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="payment_methods">Méthodes de paiement</h5>
                            </div>
                            <div class="card-body">
                                <div class="payment-method-card selected">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-user-shield payment-method-icon"></i>
                                        <div>
                                            <h6 class="mb-0" data-i18n="admin_recharge">Recharge par administrateur</h6>
                                            <small class="text-muted" data-i18n="admin_recharge_desc">Contactez l'administrateur pour recharger votre compte</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="payment-method-card">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-money-bill-wave payment-method-icon"></i>
                                        <div>
                                            <h6 class="mb-0" data-i18n="cash_payment">Paiement en espèces</h6>
                                            <small class="text-muted" data-i18n="cash_payment_desc">Payez en espèces lors de la livraison</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="payment-method-card">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-mobile-alt payment-method-icon"></i>
                                        <div>
                                            <h6 class="mb-0" data-i18n="mobile_payment">Paiement mobile</h6>
                                            <small class="text-muted" data-i18n="mobile_payment_desc">Paiement via applications mobiles</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tickets Page -->
            <div id="tickets" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0" data-i18n="support_tickets">Tickets de support</h5>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newTicketModal" data-i18n="new_ticket">Nouveau ticket</button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th data-i18n="ticket_id">ID Ticket</th>
                                        <th data-i18n="subject">Sujet</th>
                                        <th data-i18n="date">Date</th>
                                        <th data-i18n="status">Statut</th>
                                        <th data-i18n="actions">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>#TKT001</td>
                                        <td>Problème de connexion</td>
                                        <td>15/10/2023</td>
                                        <td><span class="status-badge status-open" data-i18n="open">Ouvert</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" data-i18n="view">Voir</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#TKT002</td>
                                        <td>Question sur les produits</td>
                                        <td>10/10/2023</td>
                                        <td><span class="status-badge status-pending" data-i18n="pending">En attente</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" data-i18n="view">Voir</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#TKT003</td>
                                        <td>Problème de paiement</td>
                                        <td>05/10/2023</td>
                                        <td><span class="status-badge status-closed" data-i18n="closed">Fermé</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" data-i18n="view">Voir</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Page -->
            <div id="history" class="page-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0" data-i18n="purchase_history">Historique des achats</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th data-i18n="date">Date</th>
                                        <th data-i18n="product">Produit</th>
                                        <th data-i18n="type">Type</th>
                                        <th data-i18n="price">Prix</th>
                                        <th data-i18n="status">Statut</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>15/10/2023</td>
                                        <td>King 365 M3U 12 MOIS</td>
                                        <td>M3U</td>
                                        <td>350.00 MAD</td>
                                        <td><span class="badge bg-success" data-i18n="completed">Complété</span></td>
                                    </tr>
                                    <tr>
                                        <td>10/10/2023</td>
                                        <td>SMART+ Code 6 MOIS</td>
                                        <td>Code</td>
                                        <td>200.00 MAD</td>
                                        <td><span class="badge bg-success" data-i18n="completed">Complété</span></td>
                                    </tr>
                                    <tr>
                                        <td>05/10/2023</td>
                                        <td>Premium IPTV M3U 3 MOIS</td>
                                        <td>M3U</td>
                                        <td>120.00 MAD</td>
                                        <td><span class="badge bg-success" data-i18n="completed">Complété</span></td>
                                    </tr>
                                    <tr>
                                        <td>01/10/2023</td>
                                        <td>Basic IPTV Code 1 MOIS</td>
                                        <td>Code</td>
                                        <td>50.00 MAD</td>
                                        <td><span class="badge bg-success" data-i18n="completed">Complété</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Generator Page -->
            <div id="generator" class="page-content" style="display: none;">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="code_generator">Générateur de codes</h5>
                            </div>
                            <div class="card-body">
                                <form id="generator-form">
                                    <div class="mb-3">
                                        <label for="product-select" class="form-label" data-i18n="select_product">Sélectionner un produit</label>
                                        <select class="form-select" id="product-select" required>
                                            <option value="" data-i18n="choose_product">Choisir un produit</option>
                                            <option value="1">King 365 M3U 12 MOIS</option>
                                            <option value="2">SMART+ Code 6 MOIS</option>
                                            <option value="3">Premium IPTV M3U 3 MOIS</option>
                                            <option value="4">Basic IPTV Code 1 MOIS</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="quantity" class="form-label" data-i18n="quantity">Quantité</label>
                                        <input type="number" class="form-control" id="quantity" min="1" max="10" value="1" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="duration" class="form-label" data-i18n="duration">Durée</label>
                                        <select class="form-select" id="duration" required>
                                            <option value="1" data-i18n="1_month">1 Mois</option>
                                            <option value="3" data-i18n="3_months">3 Mois</option>
                                            <option value="6" data-i18n="6_months">6 Mois</option>
                                            <option value="12" data-i18n="12_months">12 Mois</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-primary" data-i18n="generate_codes">Générer les codes</button>
                                </form>
                                <div id="generated-codes" class="mt-4" style="display: none;">
                                    <h6 data-i18n="generated_codes">Codes générés:</h6>
                                    <div class="code-list">
                                        <!-- Codes will be populated by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="recent_codes">Codes récents</h5>
                            </div>
                            <div class="card-body">
                                <div class="code-item">
                                    <div>
                                        <div class="fw-bold">King 365 M3U</div>
                                        <small class="text-muted">12 MOIS - 15/10/2023</small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary"><i class="fas fa-copy"></i></button>
                                </div>
                                <div class="code-item">
                                    <div>
                                        <div class="fw-bold">SMART+ Code</div>
                                        <small class="text-muted">6 MOIS - 10/10/2023</small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary"><i class="fas fa-copy"></i></button>
                                </div>
                                <div class="code-item">
                                    <div>
                                        <div class="fw-bold">Premium IPTV</div>
                                        <small class="text-muted">3 MOIS - 05/10/2023</small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary"><i class="fas fa-copy"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Page -->
            <div id="admin" class="page-content" style="display: none;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0" data-i18n="admin_dashboard">Tableau de bord administrateur</h5>
                            </div>
                            <div class="card-body">
                                <ul class="nav nav-tabs" id="adminTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab" aria-controls="users" aria-selected="true" data-i18n="users">Utilisateurs</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="products-tab" data-bs-toggle="tab" data-bs-target="#products-admin" type="button" role="tab" aria-controls="products-admin" aria-selected="false" data-i18n="products">Produits</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="recharges-tab" data-bs-toggle="tab" data-bs-target="#recharges" type="button" role="tab" aria-controls="recharges" aria-selected="false" data-i18n="recharges">Recharges</button>
                                    </li>
                                </ul>
                                <div class="tab-content mt-3" id="adminTabContent">
                                    <!-- Users Tab -->
                                    <div class="tab-pane fade show active" id="users" role="tabpanel" aria-labelledby="users-tab">
                                        <div class="d-flex justify-content-between mb-3">
                                            <h5 data-i18n="user_management">Gestion des utilisateurs</h5>
                                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addUserModal" data-i18n="add_user">Ajouter un utilisateur</button>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th data-i18n="name">Nom</th>
                                                        <th data-i18n="email">Email</th>
                                                        <th data-i18n="role">Rôle</th>
                                                        <th data-i18n="balance">Solde</th>
                                                        <th data-i18n="status">Statut</th>
                                                        <th data-i18n="actions">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="users-table">
                                                    <!-- Users will be populated by JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <!-- Products Tab -->
                                    <div class="tab-pane fade" id="products-admin" role="tabpanel" aria-labelledby="products-tab">
                                        <div class="d-flex justify-content-between mb-3">
                                            <h5 data-i18n="product_management">Gestion des produits</h5>
                                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProductModal" data-i18n="add_product">Ajouter un produit</button>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th data-i18n="product">Produit</th>
                                                        <th data-i18n="category">Catégorie</th>
                                                        <th data-i18n="subcategory">Sous-catégorie</th>
                                                        <th data-i18n="price">Prix</th>
                                                        <th data-i18n="stock">Stock</th>
                                                        <th data-i18n="status">Statut</th>
                                                        <th data-i18n="actions">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="products-admin-table">
                                                    <!-- Products will be populated by JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <!-- Recharges Tab -->
                                    <div class="tab-pane fade" id="recharges" role="tabpanel" aria-labelledby="recharges-tab">
                                        <h5 data-i18n="recharge_requests">Demandes de recharge</h5>
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th data-i18n="user">Utilisateur</th>
                                                        <th data-i18n="amount">Montant</th>
                                                        <th data-i18n="method">Méthode</th>
                                                        <th data-i18n="date">Date</th>
                                                        <th data-i18n="status">Statut</th>
                                                        <th data-i18n="actions">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Ahmed Ben</td>
                                                        <td>200.00 MAD</td>
                                                        <td>Admin</td>
                                                        <td>15/10/2023</td>
                                                        <td><span class="badge bg-warning" data-i18n="pending">En attente</span></td>
                                                        <td>
                                                            <button class="btn btn-sm btn-success" data-i18n="approve">Approuver</button>
                                                            <button class="btn btn-sm btn-danger" data-i18n="reject">Rejeter</button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Fatima Zohra</td>
                                                        <td>500.00 MAD</td>
                                                        <td>Admin</td>
                                                        <td>14/10/2023</td>
                                                        <td><span class="badge bg-success" data-i18n="completed">Complétée</span></td>
                                                        <td>
                                                            <button class="btn btn-sm btn-primary" data-i18n="view">Voir</button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Recharge Modal -->
    <div class="modal fade" id="rechargeModal" tabindex="-1" aria-labelledby="rechargeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="rechargeModalLabel" data-i18n="request_recharge">Demander une recharge</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="recharge-form">
                        <div class="mb-3">
                            <label for="recharge-amount" class="form-label" data-i18n="amount">Montant (MAD)</label>
                            <input type="number" class="form-control" id="recharge-amount" min="100" step="50" required>
                            <div class="form-text" data-i18n="minimum_amount">Le montant minimum est de 100 MAD</div>
                        </div>
                        <div class="mb-3">
                            <label for="recharge-method" class="form-label" data-i18n="payment_method">Méthode de paiement</label>
                            <select class="form-select" id="recharge-method" required>
                                <option value="admin" data-i18n="admin_recharge">Recharge par administrateur</option>
                                <option value="cash" data-i18n="cash_payment">Paiement en espèces</option>
                                <option value="mobile" data-i18n="mobile_payment">Paiement mobile</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="recharge-note" class="form-label" data-i18n="note">Note (optionnel)</label>
                            <textarea class="form-control" id="recharge-note" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n="cancel">Annuler</button>
                    <button type="button" class="btn btn-primary" id="submit-recharge" data-i18n="submit_request">Soumettre la demande</button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Ticket Modal -->
    <div class="modal fade" id="newTicketModal" tabindex="-1" aria-labelledby="newTicketModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newTicketModalLabel" data-i18n="new_ticket">Nouveau ticket</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="ticket-form">
                        <div class="mb-3">
                            <label for="ticket-subject" class="form-label" data-i18n="subject">Sujet</label>
                            <input type="text" class="form-control" id="ticket-subject" required>
                        </div>
                        <div class="mb-3">
                            <label for="ticket-message" class="form-label" data-i18n="message">Message</label>
                            <textarea class="form-control" id="ticket-message" rows="5" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="ticket-priority" class="form-label" data-i18n="priority">Priorité</label>
                            <select class="form-select" id="ticket-priority">
                                <option value="low" data-i18n="low">Faible</option>
                                <option value="medium" data-i18n="medium">Moyenne</option>
                                <option value="high" data-i18n="high">Élevée</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n="cancel">Annuler</button>
                    <button type="button" class="btn btn-primary" id="submit-ticket" data-i18n="submit_ticket">Soumettre le ticket</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addUserModalLabel" data-i18n="add_user">Ajouter un utilisateur</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="add-user-form">
                        <div class="mb-3">
                            <label for="user-name" class="form-label" data-i18n="full_name">Nom complet</label>
                            <input type="text" class="form-control" id="user-name" required>
                        </div>
                        <div class="mb-3">
                            <label for="user-email" class="form-label" data-i18n="email">Email</label>
                            <input type="email" class="form-control" id="user-email" required>
                        </div>
                        <div class="mb-3">
                            <label for="user-password" class="form-label" data-i18n="password">Mot de passe</label>
                            <input type="password" class="form-control" id="user-password" required>
                        </div>
                        <div class="mb-3">
                            <label for="user-role" class="form-label" data-i18n="role">Rôle</label>
                            <select class="form-select" id="user-role" required>
                                <option value="user" data-i18n="user">Utilisateur</option>
                                <option value="test" data-i18n="test_user">Utilisateur de test (48h)</option>
                                <option value="admin" data-i18n="admin">Administrateur</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="user-balance" class="form-label" data-i18n="initial_balance">Solde initial (MAD)</label>
                            <input type="number" class="form-control" id="user-balance" min="0" value="0">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n="cancel">Annuler</button>
                    <button type="button" class="btn btn-primary" id="submit-user" data-i18n="add_user">Ajouter l'utilisateur</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProductModalLabel" data-i18n="add_product">Ajouter un produit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="add-product-form">
                        <div class="mb-3">
                            <label for="product-name" class="form-label" data-i18n="product_name">Nom du produit</label>
                            <input type="text" class="form-control" id="product-name" required>
                        </div>
                        <div class="mb-3">
                            <label for="product-category" class="form-label" data-i18n="category">Catégorie</label>
                            <select class="form-select" id="product-category" required>
                                <option value="M3U">M3U</option>
                                <option value="Code">Code</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="product-subcategory" class="form-label" data-i18n="subcategory">Sous-catégorie</label>
                            <select class="form-select" id="product-subcategory" required>
                                <option value="1" data-i18n="1_month">1 Mois</option>
                                <option value="2" data-i18n="2_months">2 Mois</option>
                                <option value="3" data-i18n="3_months">3 Mois</option>
                                <option value="4" data-i18n="4_months">4 Mois</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="product-price" class="form-label" data-i18n="price">Prix (MAD)</label>
                            <input type="number" class="form-control" id="product-price" min="0" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label for="product-stock" class="form-label" data-i18n="stock">Stock</label>
                            <input type="number" class="form-control" id="product-stock" min="0" value="0">
                        </div>
                        <div class="mb-3">
                            <label for="product-description" class="form-label" data-i18n="description">Description</label>
                            <textarea class="form-control" id="product-description" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n="cancel">Annuler</button>
                    <button type="button" class="btn btn-primary" id="submit-product" data-i18n="add_product">Ajouter le produit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Purchase Success Modal -->
    <div class="modal fade" id="purchaseSuccessModal" tabindex="-1" aria-labelledby="purchaseSuccessModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-body purchase-success">
                    <i class="fas fa-check-circle"></i>
                    <h5 data-i18n="purchase_success">Achat réussi!</h5>
                    <p data-i18n="purchase_success_message">Votre produit a été acheté avec succès.</p>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" data-i18n="ok">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Promotion Popup -->
    <div class="promotion-popup" id="promotion-popup">
        <div class="promotion-header">
            <h4 data-i18n="special_offer">Offre spéciale!</h4>
        </div>
        <div class="promotion-body">
            <p data-i18n="promotion_message">Profitez de notre offre spéciale: 20% de réduction sur tous les produits M3U ce mois-ci!</p>
            <div class="d-grid">
                <button class="btn btn-primary" id="close-promotion" data-i18n="close">Fermer</button>
            </div>
        </div>
    </div>
    <div class="promotion-overlay" id="promotion-overlay"></div>

    <!-- Bootstrap & jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Language Management
        const translations = {
            fr: {
                // Login Page
                "login_title": "Connexion à votre compte",
                "email": "Email",
                "email_placeholder": "Votre email",
                "password": "Mot de passe",
                "password_placeholder": "Votre mot de passe",
                "remember_me": "Se souvenir de moi",
                "login_button": "Se connecter",
                "demo_account": "Compte de démonstration:",
                
                // Navigation
                "dashboard": "Tableau de bord",
                "products": "Produits IPTV",
                "balance": "Mon solde",
                "tickets": "Tickets",
                "history": "Historique",
                "generator": "Générateur",
                "administration": "Administration",
                "logout": "Déconnexion",
                
                // Dashboard
                "current_balance": "Solde actuel",
                "available_products": "Produits disponibles",
                "monthly_sales": "Ventes ce mois",
                "open_tickets": "Tickets ouverts",
                "popular_products": "Produits populaires",
                "recent_activity": "Dernières activités",
                "product": "Produit",
                "price": "Prix",
                "sales": "Ventes",
                "status": "Statut",
                "sales_statistics": "Statistiques des ventes",
                
                // Products Page
                "product_catalog": "Catalogue des produits IPTV",
                "search_product": "Rechercher un produit...",
                "filter_by_category": "Filtrer par catégorie:",
                "all_categories": "Toutes les catégories",
                "buy_now": "Acheter maintenant",
                "out_of_stock": "Rupture de stock",
                
                // Balance Page
                "my_balance": "Mon solde",
                "recharge_balance": "Recharger mon solde",
                "choose_payment_method": "Choisissez votre méthode de paiement",
                "request_recharge": "Demander une recharge",
                "recharge_history": "Historique des rechargements",
                "date": "Date",
                "amount": "Montant",
                "method": "Méthode",
                "completed": "Complétée",
                "payment_methods": "Méthodes de paiement",
                "admin_recharge": "Recharge par administrateur",
                "admin_recharge_desc": "Contactez l'administrateur pour recharger votre compte",
                "cash_payment": "Paiement en espèces",
                "cash_payment_desc": "Payez en espèces lors de la livraison",
                "mobile_payment": "Paiement mobile",
                "mobile_payment_desc": "Paiement via applications mobiles",
                
                // Tickets Page
                "support_tickets": "Tickets de support",
                "new_ticket": "Nouveau ticket",
                "ticket_id": "ID Ticket",
                "subject": "Sujet",
                "actions": "Actions",
                "view": "Voir",
                "open": "Ouvert",
                "pending": "En attente",
                "closed": "Fermé",
                
                // History Page
                "purchase_history": "Historique des achats",
                "type": "Type",
                
                // Generator Page
                "code_generator": "Générateur de codes",
                "select_product": "Sélectionner un produit",
                "choose_product": "Choisir un produit",
                "quantity": "Quantité",
                "duration": "Durée",
                "1_month": "1 Mois",
                "3_months": "3 Mois",
                "6_months": "6 Mois",
                "12_months": "12 Mois",
                "generate_codes": "Générer les codes",
                "generated_codes": "Codes générés:",
                "recent_codes": "Codes récents",
                
                // Admin Page
                "admin_dashboard": "Tableau de bord administrateur",
                "users": "Utilisateurs",
                "user_management": "Gestion des utilisateurs",
                "add_user": "Ajouter un utilisateur",
                "name": "Nom",
                "role": "Rôle",
                "user": "Utilisateur",
                "test_user": "Utilisateur de test (48h)",
                "admin": "Administrateur",
                "product_management": "Gestion des produits",
                "add_product": "Ajouter un produit",
                "category": "Catégorie",
                "subcategory": "Sous-catégorie",
                "stock": "Stock",
                "recharges": "Recharges",
                "recharge_requests": "Demandes de recharge",
                "approve": "Approuver",
                "reject": "Rejeter",
                
                // Modals
                "cancel": "Annuler",
                "note": "Note (optionnel)",
                "minimum_amount": "Le montant minimum est de 100 MAD",
                "submit_request": "Soumettre la demande",
                "message": "Message",
                "priority": "Priorité",
                "low": "Faible",
                "medium": "Moyenne",
                "high": "Élevée",
                "submit_ticket": "Soumettre le ticket",
                "full_name": "Nom complet",
                "initial_balance": "Solde initial (MAD)",
                "product_name": "Nom du produit",
                "description": "Description",
                "purchase_success": "Achat réussi!",
                "purchase_success_message": "Votre produit a été acheté avec succès.",
                "ok": "OK",
                "special_offer": "Offre spéciale!",
                "promotion_message": "Profitez de notre offre spéciale: 20% de réduction sur tous les produits M3U ce mois-ci!",
                "close": "Fermer",
                
                // Other
                "marquee_message": "IMPORTANT : Le montant minimum de recharge est de 500 DH. Veuillez vous assurer d'avoir un solde suffisant avant de faire un achat.",
                "test_user_countdown": "Temps restant pour votre compte test: "
            },
            ar: {
                // Login Page
                "login_title": "تسجيل الدخول إلى حسابك",
                "email": "البريد الإلكتروني",
                "email_placeholder": "بريدك الإلكتروني",
                "password": "كلمة المرور",
                "password_placeholder": "كلمة المرور الخاصة بك",
                "remember_me": "تذكرني",
                "login_button": "تسجيل الدخول",
                "demo_account": "حساب تجريبي:",
                
                // Navigation
                "dashboard": "لوحة التحكم",
                "products": "منتجات IPTV",
                "balance": "رصيدي",
                "tickets": "التذاكر",
                "history": "السجل",
                "generator": "المولد",
                "administration": "الإدارة",
                "logout": "تسجيل الخروج",
                
                // Dashboard
                "current_balance": "الرصيد الحالي",
                "available_products": "المنتجات المتاحة",
                "monthly_sales": "المبيعات هذا الشهر",
                "open_tickets": "التذاكر المفتوحة",
                "popular_products": "المنتجات الشعبية",
                "recent_activity": "النشاط الأخير",
                "product": "المنتج",
                "price": "السعر",
                "sales": "المبيعات",
                "status": "الحالة",
                "sales_statistics": "إحصائيات المبيعات",
                
                // Products Page
                "product_catalog": "كتالوج منتجات IPTV",
                "search_product": "البحث عن منتج...",
                "filter_by_category": "تصفية حسب الفئة:",
                "all_categories": "جميع الفئات",
                "buy_now": "اشتر الآن",
                "out_of_stock": "نفد من المخزون",
                
                // Balance Page
                "my_balance": "رصيدي",
                "recharge_balance": "إعادة شحن رصيدي",
                "choose_payment_method": "اختر طريقة الدفع الخاصة بك",
                "request_recharge": "طلب إعادة الشحن",
                "recharge_history": "سجل إعادة الشحن",
                "date": "التاريخ",
                "amount": "المبلغ",
                "method": "الطريقة",
                "completed": "مكتمل",
                "payment_methods": "طرق الدفع",
                "admin_recharge": "إعادة الشحن بواسطة المسؤول",
                "admin_recharge_desc": "اتصل بالمسؤول لإعادة شحن حسابك",
                "cash_payment": "الدفع نقداً",
                "cash_payment_desc": "ادفع نقداً عند التسليم",
                "mobile_payment": "الدفع عبر الهاتف المحمول",
                "mobile_payment_desc": "الدفع عبر التطبيقات المحمولة",
                
                // Tickets Page
                "support_tickets": "تذاكر الدعم",
                "new_ticket": "تذكرة جديدة",
                "ticket_id": "معرف التذكرة",
                "subject": "الموضوع",
                "actions": "الإجراءات",
                "view": "عرض",
                "open": "مفتوح",
                "pending": "قيد الانتظار",
                "closed": "مغلق",
                
                // History Page
                "purchase_history": "سجل المشتريات",
                "type": "النوع",
                
                // Generator Page
                "code_generator": "مولد الرموز",
                "select_product": "اختر المنتج",
                "choose_product": "اختر منتج",
                "quantity": "الكمية",
                "duration": "المدة",
                "1_month": "1 شهر",
                "3_months": "3 أشهر",
                "6_months": "6 أشهر",
                "12_months": "12 شهر",
                "generate_codes": "إنشاء الرموز",
                "generated_codes": "الرموز المُنشأة:",
                "recent_codes": "الرموز الحديثة",
                
                // Admin Page
                "admin_dashboard": "لوحة تحكم المسؤول",
                "users": "المستخدمين",
                "user_management": "إدارة المستخدمين",
                "add_user": "إضافة مستخدم",
                "name": "الاسم",
                "role": "الدور",
                "user": "مستخدم",
                "test_user": "مستخدم تجريبي (48 ساعة)",
                "admin": "مسؤول",
                "product_management": "إدارة المنتجات",
                "add_product": "إضافة منتج",
                "category": "الفئة",
                "subcategory": "الفئة الفرعية",
                "stock": "المخزون",
                "recharges": "إعادة الشحن",
                "recharge_requests": "طلبات إعادة الشحن",
                "approve": "موافقة",
                "reject": "رفض",
                
                // Modals
                "cancel": "إلغاء",
                "note": "ملاحظة (اختياري)",
                "minimum_amount": "الحد الأدنى للمبلغ هو 100 درهم",
                "submit_request": "إرسال الطلب",
                "message": "الرسالة",
                "priority": "الأولوية",
                "low": "منخفض",
                "medium": "متوسط",
                "high": "مرتفع",
                "submit_ticket": "إرسال التذكرة",
                "full_name": "الاسم الكامل",
                "initial_balance": "الرصيد الأولي (درهم)",
                "product_name": "اسم المنتج",
                "description": "الوصف",
                "purchase_success": "تم الشراء بنجاح!",
                "purchase_success_message": "تم شراء منتجك بنجاح.",
                "ok": "موافق",
                "special_offer": "عرض خاص!",
                "promotion_message": "استفد من عرضنا الخاص: خصم 20٪ على جميع منتجات M3U هذا الشهر!",
                "close": "إغلاق",
                
                // Other
                "marquee_message": "هام: الحد الأدنى لمبلغ إعادة الشحن هو 500 درهم. يرجى التأكد من وجود رصيد كافٍ قبل إجراء عملية شراء.",
                "test_user_countdown": "الوقت المتبقي لحسابك التجريبي: "
            }
        };

        let currentLang = 'fr';

        function changeLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });
            
            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Update RTL for Arabic
            if (lang === 'ar') {
                document.body.classList.add('arabic-text');
            } else {
                document.body.classList.remove('arabic-text');
            }
        }

        // Language switcher event
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const lang = this.getAttribute('data-lang');
                changeLanguage(lang);
            });
        });

        // User Management
        let users = [
            { id: 1, name: "Admin User", email: "admin@shop4panel.com", password: "admin123", role: "admin", balance: 1500.00, status: "active" },
            { id: 2, name: "Test User", email: "user@shop4panel.com", password: "user123", role: "user", balance: 500.00, status: "active" },
            { id: 3, name: "Ahmed Ben", email: "ahmed@example.com", password: "password123", role: "user", balance: 200.00, status: "active" },
            { id: 4, name: "Fatima Zohra", email: "fatima@example.com", password: "password123", role: "test", balance: 0.00, status: "active", testExpiry: new Date(Date.now() + 48 * 60 * 60 * 1000) }
        ];

        // Products Management
        let products = [
            { id: 1, name: "King 365 M3U 12 MOIS", category: "M3U", subcategory: "12", price: 350.00, stock: 10, image: "https://via.placeholder.com/300x150?text=King+365+M3U", features: ["4K Quality", "10,000+ Channels", "VOD"] },
            { id: 2, name: "SMART+ Code 6 MOIS", category: "Code", subcategory: "6", price: 200.00, stock: 15, image: "https://via.placeholder.com/300x150?text=SMART%2B+Code", features: ["Full HD", "5,000+ Channels", "Multi-Device"] },
            { id: 3, name: "Premium IPTV M3U 3 MOIS", category: "M3U", subcategory: "3", price: 120.00, stock: 20, image: "https://via.placeholder.com/300x150?text=Premium+IPTV+M3U", features: ["HD Quality", "8,000+ Channels", "24/7 Support"] },
            { id: 4, name: "Basic IPTV Code 1 MOIS", category: "Code", subcategory: "1", price: 50.00, stock: 25, image: "https://via.placeholder.com/300x150?text=Basic+IPTV+Code", features: ["SD Quality", "3,000+ Channels", "Easy Setup"] },
            { id: 5, name: "Elite M3U 4 MOIS", category: "M3U", subcategory: "4", price: 180.00, stock: 12, image: "https://via.placeholder.com/300x150?text=Elite+M3U", features: ["4K & HD", "12,000+ Channels", "Anti-Freeze"] },
            { id: 6, name: "Pro Code 2 MOIS", category: "Code", subcategory: "2", price: 90.00, stock: 18, image: "https://via.placeholder.com/300x150?text=Pro+Code", features: ["Full HD", "6,000+ Channels", "Multi-Screen"] }
        ];

        // Sales Data for Chart
        const salesData = {
            labels: ["King 365 M3U", "SMART+ Code", "Premium IPTV", "Basic IPTV", "Elite M3U", "Pro Code"],
            datasets: [{
                label: 'Ventes',
                data: [65, 59, 80, 81, 56, 55],
                backgroundColor: [
                    'rgba(52, 152, 219, 0.7)',
                    'rgba(46, 204, 113, 0.7)',
                    'rgba(155, 89, 182, 0.7)',
                    'rgba(52, 73, 94, 0.7)',
                    'rgba(241, 196, 15, 0.7)',
                    'rgba(230, 126, 34, 0.7)'
                ],
                borderColor: [
                    'rgb(52, 152, 219)',
                    'rgb(46, 204, 113)',
                    'rgb(155, 89, 182)',
                    'rgb(52, 73, 94)',
                    'rgb(241, 196, 15)',
                    'rgb(230, 126, 34)'
                ],
                borderWidth: 1
            }]
        };

        // Current User
        let currentUser = null;

        // DOM Ready
        $(document).ready(function() {
            // Initialize language
            changeLanguage('fr');
            
            // Login Form Submission
            $('#login-form').on('submit', function(e) {
                e.preventDefault();
                const email = $('#email').val();
                const password = $('#password').val();
                
                const user = users.find(u => u.email === email && u.password === password);
                
                if (user) {
                    currentUser = user;
                    $('#login-page').hide();
                    $('#dashboard').show();
                    
                    // Update user info
                    $('#user-name').text(user.name);
                    $('#user-avatar').text(user.name.split(' ').map(n => n[0]).join(''));
                    $('#user-role').text(user.role === 'admin' ? 'Administrateur' : (user.role === 'test' ? 'Utilisateur de test' : 'Utilisateur'));
                    $('#user-balance').text(user.balance.toFixed(2) + ' MAD');
                    $('#current-balance').text(user.balance.toFixed(2) + ' MAD');
                    
                    // Show admin menu if user is admin
                    if (user.role === 'admin') {
                        $('#admin-menu-item').show();
                        $('#sales-chart-container').show();
                        initializeSalesChart();
                    } else {
                        $('#admin-menu-item').hide();
                        $('#sales-chart-container').hide();
                    }
                    
                    // Show test user countdown if user is test
                    if (user.role === 'test') {
                        $('#test-user-countdown').show();
                        startTestUserCountdown();
                    } else {
                        $('#test-user-countdown').hide();
                    }
                    
                    // Load products
                    loadProducts();
                    loadPopularProducts();
                    loadUsersTable();
                    loadProductsAdminTable();
                } else {
                    alert('Email ou mot de passe incorrect!');
                }
            });
            
            // Navigation
            $('.sidebar-menu a').on('click', function(e) {
                e.preventDefault();
                
                // Update active menu item
                $('.sidebar-menu a').removeClass('active');
                $(this).addClass('active');
                
                // Show corresponding page
                const page = $(this).data('page');
                $('.page-content').hide();
                $('#' + page).show();
                
                // Update page title
                const pageTitle = $(this).find('span').text();
                $('#page-title').text(pageTitle);
            });
            
            // Logout
            $('#logout-btn').on('click', function() {
                currentUser = null;
                $('#dashboard').hide();
                $('#login-page').show();
                $('#login-form')[0].reset();
            });
            
            // Product Search
            $('#product-search').on('keyup', function() {
                const searchTerm = $(this).val().toLowerCase();
                filterProducts(searchTerm);
            });
            
            // Category Filter
            $('#category-filter').on('change', function() {
                const category = $(this).val();
                filterProductsByCategory(category);
            });
            
            // Recharge Form
            $('#submit-recharge').on('click', function() {
                const amount = parseFloat($('#recharge-amount').val());
                const method = $('#recharge-method').val();
                
                if (amount >= 100) {
                    alert('Demande de recharge de ' + amount + ' MAD envoyée avec succès!');
                    $('#rechargeModal').modal('hide');
                    $('#recharge-form')[0].reset();
                } else {
                    alert('Le montant minimum est de 100 MAD');
                }
            });
            
            // Ticket Form
            $('#submit-ticket').on('click', function() {
                const subject = $('#ticket-subject').val();
                const message = $('#ticket-message').val();
                
                if (subject && message) {
                    alert('Ticket créé avec succès!');
                    $('#newTicketModal').modal('hide');
                    $('#ticket-form')[0].reset();
                } else {
                    alert('Veuillez remplir tous les champs obligatoires');
                }
            });
            
            // Add User Form
            $('#submit-user').on('click', function() {
                const name = $('#user-name').val();
                const email = $('#user-email').val();
                const password = $('#user-password').val();
                const role = $('#user-role').val();
                const balance = parseFloat($('#user-balance').val()) || 0;
                
                if (name && email && password) {
                    const newUser = {
                        id: users.length + 1,
                        name: name,
                        email: email,
                        password: password,
                        role: role,
                        balance: balance,
                        status: 'active'
                    };
                    
                    if (role === 'test') {
                        newUser.testExpiry = new Date(Date.now() + 48 * 60 * 60 * 1000);
                    }
                    
                    users.push(newUser);
                    loadUsersTable();
                    alert('Utilisateur ajouté avec succès!');
                    $('#addUserModal').modal('hide');
                    $('#add-user-form')[0].reset();
                } else {
                    alert('Veuillez remplir tous les champs obligatoires');
                }
            });
            
            // Add Product Form
            $('#submit-product').on('click', function() {
                const name = $('#product-name').val();
                const category = $('#product-category').val();
                const subcategory = $('#product-subcategory').val();
                const price = parseFloat($('#product-price').val());
                const stock = parseInt($('#product-stock').val()) || 0;
                const description = $('#product-description').val();
                
                if (name && category && subcategory && price >= 0) {
                    const newProduct = {
                        id: products.length + 1,
                        name: name,
                        category: category,
                        subcategory: subcategory,
                        price: price,
                        stock: stock,
                        description: description,
                        image: `https://via.placeholder.com/300x150?text=${encodeURIComponent(name)}`,
                        features: ["HD Quality", "Multiple Channels", "VOD"]
                    };
                    
                    products.push(newProduct);
                    loadProducts();
                    loadProductsAdminTable();
                    alert('Produit ajouté avec succès!');
                    $('#addProductModal').modal('hide');
                    $('#add-product-form')[0].reset();
                } else {
                    alert('Veuillez remplir tous les champs obligatoires');
                }
            });
            
            // Code Generator
            $('#generator-form').on('submit', function(e) {
                e.preventDefault();
                const productId = $('#product-select').val();
                const quantity = $('#quantity').val();
                const duration = $('#duration').val();
                
                if (productId && quantity && duration) {
                    const product = products.find(p => p.id == productId);
                    if (product) {
                        let codesHtml = '';
                        for (let i = 0; i < quantity; i++) {
                            const code = generateCode(16);
                            codesHtml += `
                                <div class="code-item">
                                    <div>
                                        <div class="fw-bold">${code}</div>
                                        <small class="text-muted">${product.name} - ${duration} Mois</small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary copy-code" data-code="${code}">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            `;
                        }
                        $('.code-list').html(codesHtml);
                        $('#generated-codes').show();
                        
                        // Add copy functionality
                        $('.copy-code').on('click', function() {
                            const code = $(this).data('code');
                            navigator.clipboard.writeText(code).then(function() {
                                alert('Code copié: ' + code);
                            });
                        });
                    }
                }
            });
            
            // Close Promotion
            $('#close-promotion').on('click', function() {
                $('#promotion-popup').fadeOut();
                $('#promotion-overlay').fadeOut();
            });
            
            // Show promotion after 3 seconds
            setTimeout(function() {
                $('#promotion-popup').fadeIn();
                $('#promotion-overlay').fadeIn();
            }, 3000);
        });
        
        // Load Products
        function loadProducts() {
            const container = $('#products-container');
            container.empty();
            
            products.forEach(product => {
                const productHtml = `
                    <div class="col-md-4 mb-4 product-item" data-category="${product.category}">
                        <div class="card product-card h-100">
                            <div class="product-image" style="background-image: url('${product.image}')"></div>
                            <div class="product-price">${product.price.toFixed(2)} MAD</div>
                            <div class="card-body">
                                <h5 class="product-title">${product.name}</h5>
                                <div class="product-duration">${getDurationText(product.subcategory)}</div>
                                <div class="product-features">
                                    ${product.features.map(feature => `<span class="product-feature">${feature}</span>`).join('')}
                                </div>
                                <div class="product-stats">
                                    <div class="stat-item">
                                        <i class="fas fa-layer-group"></i>
                                        <span>${product.category}</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-box"></i>
                                        <span>Stock: ${product.stock}</span>
                                    </div>
                                </div>
                                <div class="d-grid mt-3">
                                    ${product.stock > 0 ? 
                                        `<button class="btn btn-primary buy-product" data-id="${product.id}" data-i18n="buy_now">Acheter maintenant</button>` : 
                                        `<button class="btn btn-secondary" disabled data-i18n="out_of_stock">Rupture de stock</button>`
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.append(productHtml);
            });
            
            // Add buy product event
            $('.buy-product').on('click', function() {
                const productId = $(this).data('id');
                const product = products.find(p => p.id === productId);
                
                if (product && currentUser) {
                    if (currentUser.balance >= product.price) {
                        currentUser.balance -= product.price;
                        product.stock -= 1;
                        
                        $('#user-balance').text(currentUser.balance.toFixed(2) + ' MAD');
                        $('#current-balance').text(currentUser.balance.toFixed(2) + ' MAD');
                        
                        loadProducts();
                        loadPopularProducts();
                        
                        $('#purchaseSuccessModal').modal('show');
                    } else {
                        alert('Solde insuffisant! Veuillez recharger votre compte.');
                    }
                }
            });
        }
        
        // Load Popular Products
        function loadPopularProducts() {
            const container = $('#popular-products');
            container.empty();
            
            // Sort products by sales (simulated)
            const popularProducts = [...products].sort((a, b) => b.stock - a.stock).slice(0, 5);
            
            popularProducts.forEach(product => {
                const productHtml = `
                    <tr>
                        <td>${product.name}</td>
                        <td>${product.price.toFixed(2)} MAD</td>
                        <td>${Math.floor(Math.random() * 20) + 5}</td>
                        <td><span class="badge bg-success">En stock</span></td>
                    </tr>
                `;
                container.append(productHtml);
            });
        }
        
        // Load Users Table
        function loadUsersTable() {
            const container = $('#users-table');
            container.empty();
            
            users.forEach(user => {
                const userHtml = `
                    <tr>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>
                            ${user.role === 'admin' ? 'Administrateur' : (user.role === 'test' ? 'Utilisateur de test' : 'Utilisateur')}
                            ${user.role === 'test' ? '<span class="category-badge">48h</span>' : ''}
                        </td>
                        <td>${user.balance.toFixed(2)} MAD</td>
                        <td><span class="badge bg-success">Actif</span></td>
                        <td>
                            <button class="btn btn-sm btn-primary">Modifier</button>
                            <button class="btn btn-sm btn-danger">Supprimer</button>
                        </td>
                    </tr>
                `;
                container.append(userHtml);
            });
        }
        
        // Load Products Admin Table
        function loadProductsAdminTable() {
            const container = $('#products-admin-table');
            container.empty();
            
            products.forEach(product => {
                const productHtml = `
                    <tr>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td>${getDurationText(product.subcategory)}</td>
                        <td>${product.price.toFixed(2)} MAD</td>
                        <td>${product.stock}</td>
                        <td><span class="badge bg-success">Actif</span></td>
                        <td>
                            <button class="btn btn-sm btn-primary">Modifier</button>
                            <button class="btn btn-sm btn-danger">Supprimer</button>
                        </td>
                    </tr>
                `;
                container.append(productHtml);
            });
        }
        
        // Filter Products
        function filterProducts(searchTerm) {
            $('.product-item').each(function() {
                const productName = $(this).find('.product-title').text().toLowerCase();
                if (productName.includes(searchTerm)) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        }
        
        // Filter Products by Category
        function filterProductsByCategory(category) {
            if (category === 'all') {
                $('.product-item').show();
            } else {
                $('.product-item').each(function() {
                    if ($(this).data('category') === category) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            }
        }
        
        // Generate Random Code
        function generateCode(length) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        // Get Duration Text
        function getDurationText(subcategory) {
            switch(subcategory) {
                case '1': return '1 Mois';
                case '2': return '2 Mois';
                case '3': return '3 Mois';
                case '4': return '4 Mois';
                case '6': return '6 Mois';
                case '12': return '12 Mois';
                default: return `${subcategory} Mois`;
            }
        }
        
        // Initialize Sales Chart
        function initializeSalesChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');
            const salesChart = new Chart(ctx, {
                type: 'bar',
                data: salesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // Start Test User Countdown
        function startTestUserCountdown() {
            if (currentUser && currentUser.role === 'test' && currentUser.testExpiry) {
                const countdownElement = document.getElementById('countdown-timer');
                
                function updateCountdown() {
                    const now = new Date().getTime();
                    const distance = currentUser.testExpiry.getTime() - now;
                    
                    if (distance < 0) {
                        countdownElement.innerHTML = "EXPIRÉ";
                        return;
                    }
                    
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                    
                    countdownElement.innerHTML = `${hours}h ${minutes}m ${seconds}s`;
                }
                
                updateCountdown();
                setInterval(updateCountdown, 1000);
            }
        }
    </script>
</body>
</html>
